<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Reproducible Research - assignment 1</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Reproducible Research - assignment 1</h1>

<p>This document shows and explains the R code to read and process the personal activity dataset provided as part of the Reproducible Research course assignment 1.
We start off assuming that the data from the course&#39;s github repository, has been unzipped, and saved to the working directory as &ldquo;activity.csv&rdquo;</p>

<p>So, to load the data:</p>

<pre><code class="r">data1 &lt;- read.csv(&quot;.\\activity.csv&quot;,stringsAsFactors=FALSE)
</code></pre>

<pre><code>## Warning in file(file, &quot;rt&quot;): cannot open file &#39;.\activity.csv&#39;: No such
## file or directory
</code></pre>

<pre><code>## Error in file(file, &quot;rt&quot;): cannot open the connection
</code></pre>

<p>The package dplyr is used throughout this work. If you don&#39;t already have it installed you will need to install it on  your system, in order to reproduce the analysis. </p>

<p>The time intervals are given as hours and minutes of the day, but without leading zeros, so we tidy the code by padding with leading zeros and format this a date. R assigns this today&#39;s date; a fixed date could be used, but it&#39;s of no consequence as the date will not be used, only the time.</p>

<pre><code class="r">data1 &lt;- mutate(data1,interval = sprintf(&quot;%04d&quot;,data1$interval))
data1 &lt;- mutate(data1,interval = as.POSIXct(data1$interval,
                                            origin=&quot;2012-01-01&quot;,
                                            format =&quot;%H%M&quot;,usetz = FALSE))
</code></pre>

<p>The dates in the original dataset also need formatting as dates:</p>

<pre><code class="r">data1 &lt;- mutate(data1,date = as.POSIXct(data1$date,
                                        origin=&quot;2012-01-01&quot;,
                                        usetz = FALSE))
</code></pre>

<p>Set up the data for dplyr&hellip;</p>

<pre><code class="r">data2 &lt;- tbl_df(data1)
</code></pre>

<p>&hellip;then organise it to calculate totals per day</p>

<pre><code class="r">by_date &lt;- group_by(data2,date)
x1 &lt;- summarize(by_date,sum(steps))
colnames(x1)[2] &lt;- &quot;daily_tot_steps&quot;
</code></pre>

<h3>Histogram of total steps per day</h3>

<pre><code class="r">##png(filename=&quot;stepsperdayhisto1.png&quot;, width=480, height=480)
hist(x1$daily_tot_steps,breaks = 10, col = &quot;cornflowerblue&quot;,
     ylim = c(0,30),
     border =&quot;white&quot;,
     main = &quot;distribution of steps per day\nwith missing data&quot;,
     xlab = &quot;number of steps&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAOVBMVEX9/v0AAAAREREiIiIzMzNDRENUVVRkle1lZmV2d3aHh4eYmJipqam6urrKy8rb3Nvs7ez9/v3////u7+nrAAAAE3RSTlP//////////////////////wD/DFvO9wAAAAlwSFlzAAALEgAACxIB0t1+/AAADH9JREFUeJzt3Yl6qsgaRuEuh7RJNErf/8U2M5SKVDFo/XxrPWe3USq12bxHHILhn4wk++fTK0CfCXjRgBcNeNGAFw140YAXDXjRgBcNeNGAFw140YAXDXjRgBcNeNFswTtX/Wn6Ow4u6g14vPmh884dHr9xZgF/7+eyB//i+uOWDt32D+OWQAN+kX53u3Nzt74enDte8y/z8v9ed/v6Hn/e7X6zepOXi6oB+bXL3u0v5a35V4drPWl9azWuyJs5O7ffVPzt3eKy9sbesGJNvLW9Hl3xt+3dLbu5/ds21nhm4M+uxij+7IsvD62rc181fNH5Gfyl/LIxbvbrza0dvDdztfiv+aZLu7isvdEb9uWv7aG42GenfK3O7vSB7TaUGfiD+86+G3iX34GKauBTdqtvLsYcOvjui0M+6FQtOhZSzaTtrfVf4818yDX/CkrXjbu1a9Te6A27+Wubd80vz/niL3defzMFZwbelTvL2jLfpoefrHW9Zd3/H26e97Mvbp2zv7jobuaiXW/iZvHdGvWG3S3L/r7zO33+9S7bJfWQbwg+66H+HPf5PbeD6/hewPuLHict82duH14ax3px9c0evDdLO/HZfV+rPc757nXDhzMDX+2VnY/2AP/T7OovvcF3u/qsm+NxV+/NXOzD61u+qomzrL8C9Y29YQ9ru3PXS7Wr2Od7/4QyA3/p363Kp0zHYrPWT+sarfrp1qEZ3A7oPQHLOiH/1iJv5mrx8X7i9h7vPbk79uHbtS2eDe7qv//yzu01lhn4rHil1u60v6pXVZddvr378N2rrn35aqob0L2cy3pC3q1F3szZ797tTln9OvHcW5z1b+wNe1jba/7IcC2ezjtvp/L57MB/sqdocZKH+oVeKgEf0iLwKb2YAz6s+fDVY0FCAS8a8KIBLxrwom0Xvnju9fo4jGcLRp6x9RcvcazG59oufJH/bs1SEz752l7bgt+7a/brfspjHno/ji/fPqtG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" alt="plot of chunk unnamed-chunk-7"/> </p>

<pre><code class="r">##dev.off()
</code></pre>

<h3>Mean total steps per day:</h3>

<pre><code class="r">x2 &lt;- mean(x1$daily_tot_steps,na.rm=TRUE)
x2
</code></pre>

<pre><code>## [1] 10766.19
</code></pre>

<h3>Median total steps per day</h3>

<pre><code class="r">x3 &lt;- median(x1$daily_tot_steps,na.rm=TRUE)
x3
</code></pre>

<pre><code>## [1] 10765
</code></pre>

<p>We need to reorganise the date to calculate mean steps through day&hellip;</p>

<pre><code class="r">by_interval &lt;- group_by(data2,interval)
y1 &lt;- summarize(by_interval,mean(steps,na.rm=TRUE))
colnames(y1) &lt;- c(&quot;time_of_day&quot;,&quot;average_steps&quot;)
</code></pre>

<p>&hellip;Which allows us to plot it:</p>

<h3>Time series plot of mean steps per day</h3>

<pre><code class="r">with(y1, plot(time_of_day,average_steps,type = &quot;l&quot;,
              xlab = &quot;time of day&quot;,
              ylab = &quot;average steps&quot;,
              main =&quot;average activity over day&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/> </p>

<h3>Maximum number of steps in any interval during the day:</h3>

<pre><code class="r">pb &lt;- max(y1$average_steps)
pb
</code></pre>

<pre><code>## [1] 37.3826
</code></pre>

<h3>Time interval with highest activity:</h3>

<pre><code class="r">days_avg &lt;- arrange(y1,desc(average_steps))
pbtime &lt;- format(days_avg[1,1],format =&quot;%H:%M&quot;)
pbtime
</code></pre>

<pre><code>##   time_of_day
## 1       14:21
</code></pre>

<p>##Imputed Data</p>

<p>There are a number of time intervals for which there is no record, as opposed to intervals in which there were zero steps. We shall substitue synthetic data for these intervals, by applying the average value of steps calculated for any interval for which there is no record.
We start by organising the data into time interval order then subset it into two sets, one with NA in the steps field, and the other set with a record for number of steps. Then we substitute average values for NA values and rejoin the two data sets.</p>

<pre><code class="r">days_avg &lt;- arrange(days_avg,time_of_day)

## separate NAs from the rest
data4 &lt;- subset(data2,is.na(data2$steps),drop=FALSE)
data5 &lt;- subset(data2,!is.na(data2$steps),drop=FALSE)

## tidy and substitute average steps for NAs
data4 &lt;- data4[,2:3]
data4a &lt;- merge(data4, days_avg, by.x = &quot;interval&quot;, by.y = &quot;time_of_day&quot;)
data4a &lt;- data4a[,c(3,2,1)]
## optional rounding term to make steps integer values
data4a[1] &lt;- round(data4a[1])
colnames(data4a) &lt;- c(&quot;steps&quot;,&quot;date&quot;,&quot;interval&quot;)

## rejoin the data sets to include substituted averages
## with measured data
data6 &lt;- rbind(data4a,data5)
</code></pre>

<p>We now have a data set with values for each interval on each day, and repeat the methods previously used to provide a similar plot and calculations.</p>

<h3>Histogram of total steps for day with imputed data</h3>

<pre><code class="r">##*****tidy data for calculations per day*****
by_date2 &lt;- group_by(data6,date)
p1 &lt;- summarize(by_date2,sum(steps))
colnames(p1)[2] &lt;- &quot;daily_tot_steps&quot;

## *****plot histogram of total steps per day
##png(filename=&quot;stepsperdayhisto2.png&quot;, width=480, height=480)
hist(p1$daily_tot_steps,breaks = 10, col = &quot;cornflowerblue&quot;,
     ylim = c(0,30),
     border =&quot;white&quot;,
     main = &quot;distribution of steps per day\nwith imputed data&quot;,
     xlab = &quot;number of steps&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/> </p>

<pre><code class="r">##dev.off()
</code></pre>

<p>###Mean total steps/day with imputed data</p>

<pre><code class="r">## *****mean of total steps per day*****
p2 &lt;- mean(p1$daily_tot_steps,na.rm=TRUE)
p2
</code></pre>

<pre><code>## [1] 10751.74
</code></pre>

<p>###Median total steps/day with imputed data</p>

<pre><code class="r">## *****median of total steps per day*****
p3 &lt;- median(p1$daily_tot_steps,na.rm=TRUE)
p3
</code></pre>

<pre><code>## [1] 10656
</code></pre>

<p>##Comparing weekday and weekend activity</p>

<p>In order to compare step activity at weekends and during the week, we need to derive a weekday/weekend label from the date on which the activity is recorded.
A new data variable is created, and populated with labels calculated from the date.</p>

<pre><code class="r">##*****Add a column to show weekdays and weekends*****
data7 &lt;- mutate(data6, workweek = weekdays(date))
## as before, split into two sets assign factors and recombine
data71 &lt;- subset(data7,data7[,4]==&quot;Saturday&quot;|
                     data7[,4]==&quot;Sunday&quot;)

data72 &lt;- subset(data7,data7[,4]==&quot;Monday&quot;|
                 data7[,4]==&quot;Tuesday&quot;|
                 data7[,4]==&quot;Wednesday&quot;|
                 data7[,4]==&quot;Thursday&quot;|
                 data7[,4]==&quot;Friday&quot;)

data71 &lt;- mutate(data71,workweek=&quot;weekend&quot;)
data72 &lt;- mutate(data72,workweek=&quot;weekday&quot;)
data8 &lt;- rbind(data71,data72)
data8 &lt;- mutate(data8,workweek = as.factor(workweek))
</code></pre>

<p>Using the weekend/weekday information, we can compare the typical activity patterns for workdays and leisure days.</p>

<pre><code class="r">##*****calculate average steps per interval by weekday &amp; weekend*****
by_interval2 &lt;- group_by(data8,workweek,interval)
z1 &lt;- summarise(by_interval2,mean(steps))


colnames(z1) &lt;- c(&quot;workweek&quot;,&quot;time_of_day&quot;,&quot;average_steps&quot;)

library(lattice)
xyplot(average_steps ~ time_of_day | workweek,
       data=z1,layout =c(1,2),type = &quot;l&quot;,col = &quot;blue&quot;,
       xlab = &quot;time of day&quot;,ylab = &quot;average steps&quot;,
       scales=list(x=list(format=&quot;%H%M&quot;)))
</code></pre>

<pre><code>## Error in prettyDate_TMP(x, ...): range too small for min.n
</code></pre>

</body>

</html>
